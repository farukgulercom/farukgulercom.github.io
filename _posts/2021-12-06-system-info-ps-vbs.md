---
layout: post
title: System Info Ps-Vbs
date: 2021-12-06 13:20
author: theguler
comments: true
categories: [PowerShell]
---
<!-- wp:image {"id":2148,"width":"403px","height":"auto","sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large is-resized"><img src="https://theguler.wordpress.com/wp-content/uploads/2022/02/powershell-as-admin.webp?w=1024" alt="" class="wp-image-2148" style="width:403px;height:auto" /></figure>
<!-- /wp:image -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted"># title<br>$title = @"<br>GULER System Info<br>--------------------------------<br>"@<br><br># Ip<br>$ipAddress = (Test-Connection -ComputerName $env:COMPUTERNAME -Count 1).IPv4Address.IPAddressToString<br><br># Compname<br>$computerName = $env:COMPUTERNAME<br><br># RAM<br>$ram = Get-CimInstance -ClassName Win32_PhysicalMemory | Measure-Object -Property Capacity -Sum | ForEach-Object { "{0:N2} GB" -f ($_.Sum / 1GB) }<br><br># CPU<br>$cpu = Get-WmiObject -Class Win32_Processor | Select-Object -ExpandProperty Name<br><br># Export file etc.<br>$outputFilePath = "$env:USERPROFILE\Desktop\SystemInfo.txt"<br><br># Post file<br>"$title`r`n" + @"<br>Bilgisayar IP adresi: $ipAddress<br>Bilgisayar ismi: $computerName<br>RAM: $ram<br>CPU: $cpu<br>"@ | Set-Content -Path $outputFilePath -Encoding utf8</pre>
<!-- /wp:preformatted -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">' System Info<br>title = "GULER System Info" &amp; vbCrLf &amp; "--------------------------------"<br><br>' IP Address<br>Set objWMIService = GetObject("winmgmts:\\.\root\cimv2")<br>Set colItems = objWMIService.ExecQuery("Select * from Win32_NetworkAdapterConfiguration Where IPEnabled = True")<br><br>' Collecting all IPv4 addresses<br>Dim ipAddresses<br>ipAddresses = ""<br><br>For Each objItem in colItems<br>    If Not IsNull(objItem.IPAddress) Then<br>        For Each strIPAddress in objItem.IPAddress<br>            If InStr(strIPAddress, ":") = 0 Then ' IPv4 adreslerini filtrele<br>                ipAddresses = ipAddresses &amp; strIPAddress &amp; ", "<br>            End If<br>        Next<br>    End If<br>Next<br><br>' Remove the last comma and space<br>If Len(ipAddresses) &gt; 0 Then<br>    ipAddresses = Left(ipAddresses, Len(ipAddresses) - 2)<br>End If<br><br>' Computer Name<br>computerName = CreateObject("WScript.Network").ComputerName<br><br>' RAM<br>Set objWMIService = GetObject("winmgmts:\\.\root\cimv2")<br>Set colItems = objWMIService.ExecQuery("Select * from Win32_PhysicalMemory")<br>totalRAM = 0<br>For Each objItem in colItems<br>    totalRAM = totalRAM + objItem.Capacity<br>Next<br>ram = FormatNumber(totalRAM / (1024 * 1024 * 1024), 2) &amp; " GB"<br><br>' CPU<br>Set objWMIService = GetObject("winmgmts:\\.\root\cimv2")<br>Set colItems = objWMIService.ExecQuery("Select * from Win32_Processor")<br>For Each objItem in colItems<br>    cpu = objItem.Name<br>Next<br><br>' Disk Serial Number<br>Set colDisks = objWMIService.ExecQuery ("Select * from Win32_DiskDrive")<br>For Each objDisk in colDisks<br>    diskSerial = objDisk.SerialNumber<br>Next<br><br>' User Info<br>Set objNetwork = CreateObject("WScript.Network")<br>domain = objNetwork.UserDomain<br>username = objNetwork.UserName<br><br>' Output file<br>outputFilePath = CreateObject("WScript.Shell").SpecialFolders("Desktop") &amp; "\SystemInfo.txt"<br><br>' Write to file<br>Set objFSO = CreateObject("Scripting.FileSystemObject")<br>Set objFile = objFSO.CreateTextFile(outputFilePath, True)<br>objFile.WriteLine title<br><br>' Write IP addresses<br>objFile.WriteLine "Bilgisayar IP: " &amp; ipAddresses<br><br>objFile.WriteLine "Bilgisayar Adı: " &amp; computerName<br>objFile.WriteLine "RAM: " &amp; ram<br>objFile.WriteLine "CPU: " &amp; cpu<br>objFile.WriteLine "Disk Seri Numarası: " &amp; diskSerial<br>objFile.WriteLine "Etki Alanı: " &amp; domain<br>objFile.WriteLine "Kullanıcı Adı: " &amp; username<br>objFile.Close</pre>
<!-- /wp:preformatted -->
